# Домашнее задание №1: Линейная регрессия с инфересном
В рамках этого домашнего задания требовалось создать модель регрессии для прогнозирования стоимости автомобилей и реализовать веб-сервис для применения построенной модели на новых данных.

## Этапы работы

### 1. EDA и визуализация.
- ознакомление с данными
- анализ на пропуски и дубликаты
- заполнение пропусков медианами
- построение дашборда, используя `ydata-profilling`
- визулизация данных при помощи библиотеки `seaborn`

### 2. Построение модели на вещественных признаках.
- дополнительный анализ на дубликаты без целевой переменной
- обучение классической линейной модели с дефолтными параметрами
  - получены $R^2$ = 0.615 и $MSE$ = 136771748250.24365 на тесте
- при помощи `StandardScaler` данные были приведены к одному масштабу, но на качество модели это сильно не повлияло
- наиболее информативным оказался признак `max_power`
- был применен метод регуляризации `Lasso` без подбора коэффициента $\alpha$ (качество не поменялось)
- при помощи `GridSearchCV` нашли оптимальный гиперпараметр $\alpha$
  - получены $R^2$ = 0.596 и $MSE$ = 143445166594.93835 на тесте
- при помощи `GridSearchCV` подобраны оптимальные гиперпараметры для `ElasticNet` регрессии
  - качество не изменилось

### 3. Добавление категориальных переменных.
- При помощи OneHot-кодирования закодировали категориальные переменные
- Стандартизация данных была проведена при помощи `MinMaxScaler`
- при помощи `GridSearchCV` нашли оптимальный гиперпараметр $\alpha$ для `Ridge` регрессии
  - получены $R^2$ = 0.585 и $MSE$ = 118766323948.6503 на тесте
  - ошибка все равно большая, но меньше, чем в других моделях, $R^2$ стал немного меньше

### 4. Бизнес-часть.
- была реализована метрика `business_metric`, отражающая долю прогнозов, отличающихся от реальных цен на авто не более чем на 10% (в одну или другую сторону)
- получены результаты для всех моделей:
  - LinearRegression business metric: 0.013356164383561644
  - LinearRegression + StandartScaler business metric: 0.013356164383561644
  - Lasso + StandartScaler business metric: 0.013356164383561644
  - Lasso + StandartScaler + GridSearchCV business metric: 0.012671232876712329
  - ElasticNet + StandartScaler + GridSearchCV business metric: 0.012671232876712329
  - Ridge + category_var + MinMaxScaler + GridSearchCV business metric: 0.22534246575342465
 - Результаты анализа бизнес-метрик различных моделей демонстрируют, что хотя некоторые показатели могут указывать на высокое качество, это не всегда означает, что они будут оптимальными для бизнеса. Так, например, такие действия, как добавление `StandartScaler`, `GridSearchCV`, категориальных переменных и регуляризации приводило к понижению основных метрик $R^2$ и $MSE$. Но с точки зрения бизнеса мы видим, что именно 6 модель с применением всех вышеперечисленных действий показывает лучшие результаты.

### 5. Реализация сервиса на FastAPI.
- in progress

### Что сделать не вышло и почему
- самое главное: не вышло получить хорошие показатели метрик $R^2$ и $MSE$.
- почему: следовало обработать все категориальные признаки и добавить в модель, посмотреть на выбросы, сгенерировать новые признаки.



